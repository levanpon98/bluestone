{"ast":null,"code":"import { MongoClient } from 'mongodb';\nimport nextConnect from 'next-connect';\nconst MONGODB_URI = process.env.MONGODB_URI;\nconst MONGODB_DB = process.env.MONGODB_DB;\n\nif (!MONGODB_URI) {\n  throw new Error('Please define the MONGODB_URI environment variable inside .env.local');\n}\n\nif (!MONGODB_DB) {\n  throw new Error('Please define the MONGODB_DB environment variable inside .env.local');\n}\n\nconst client = new MongoClient(MONGODB_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n\nasync function database(req, res, next) {\n  if (!client.isConnected()) await client.connect();\n  req.dbClient = client;\n  req.db = client.db(MONGODB_DB);\n  return next();\n}\n\nconst middleware = nextConnect();\nmiddleware.use(database);\nexport default middleware;","map":{"version":3,"sources":["/home/ponlv/work/projects/hmsp/bluestone/lib/mongodb.js"],"names":["MongoClient","nextConnect","MONGODB_URI","process","env","MONGODB_DB","Error","client","useNewUrlParser","useUnifiedTopology","database","req","res","next","isConnected","connect","dbClient","db","middleware","use"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;AACA,OAAOC,WAAP,MAAwB,cAAxB;AACA,MAAMC,WAAW,GAAGC,OAAO,CAACC,GAAR,CAAYF,WAAhC;AACA,MAAMG,UAAU,GAAGF,OAAO,CAACC,GAAR,CAAYC,UAA/B;;AAEA,IAAI,CAACH,WAAL,EAAkB;AAChB,QAAM,IAAII,KAAJ,CACJ,sEADI,CAAN;AAGD;;AAED,IAAI,CAACD,UAAL,EAAiB;AACf,QAAM,IAAIC,KAAJ,CACJ,qEADI,CAAN;AAGD;;AAED,MAAMC,MAAM,GAAG,IAAIP,WAAJ,CAAgBE,WAAhB,EAA6B;AAC1CM,EAAAA,eAAe,EAAE,IADyB;AAE1CC,EAAAA,kBAAkB,EAAE;AAFsB,CAA7B,CAAf;;AAIA,eAAeC,QAAf,CAAwBC,GAAxB,EAA6BC,GAA7B,EAAkCC,IAAlC,EAAwC;AACtC,MAAI,CAACN,MAAM,CAACO,WAAP,EAAL,EAA2B,MAAMP,MAAM,CAACQ,OAAP,EAAN;AAC3BJ,EAAAA,GAAG,CAACK,QAAJ,GAAeT,MAAf;AACAI,EAAAA,GAAG,CAACM,EAAJ,GAASV,MAAM,CAACU,EAAP,CAAUZ,UAAV,CAAT;AACA,SAAOQ,IAAI,EAAX;AACD;;AACD,MAAMK,UAAU,GAAGjB,WAAW,EAA9B;AACAiB,UAAU,CAACC,GAAX,CAAeT,QAAf;AACA,eAAeQ,UAAf","sourcesContent":["import { MongoClient } from 'mongodb'\nimport nextConnect from 'next-connect';\nconst MONGODB_URI = process.env.MONGODB_URI\nconst MONGODB_DB = process.env.MONGODB_DB\n\nif (!MONGODB_URI) {\n  throw new Error(\n    'Please define the MONGODB_URI environment variable inside .env.local'\n  )\n}\n\nif (!MONGODB_DB) {\n  throw new Error(\n    'Please define the MONGODB_DB environment variable inside .env.local'\n  )\n}\n\nconst client = new MongoClient(MONGODB_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n});\nasync function database(req, res, next) {\n  if (!client.isConnected()) await client.connect();\n  req.dbClient = client;\n  req.db = client.db(MONGODB_DB);\n  return next();\n}\nconst middleware = nextConnect();\nmiddleware.use(database);\nexport default middleware;"]},"metadata":{},"sourceType":"module"}