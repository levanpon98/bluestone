{"ast":null,"code":"// src/authenticate\nimport cookie from 'js-cookie';\nimport redirect from './Redirect';\n\nvar getCookieFromBrowser = function getCookieFromBrowser(key) {\n  cookie.get(key);\n};\n\nvar getCookieFromServer = function getCookieFromServer(key, req) {\n  if (!req.headers.cookie) {\n    return undefined;\n  }\n\n  var rawCookie = req.headers.cookie.split(';').find(function (c) {\n    return c.trim().startsWith(\"\".concat(key, \"=\"));\n  });\n\n  if (!rawCookie) {\n    return undefined;\n  }\n\n  return rawCookie.split('=')[1];\n};\n\nexport var getCookie = function getCookie(key, req) {\n  return true ? getCookieFromBrowser(key) : getCookieFromServer(key, req);\n};\nexport var checkJwt = function checkJwt(ctx) {\n  var jwt = getCookie('jwt', ctx.req);\n  return !!jwt;\n};\nexport var isAuthenticated = function isAuthenticated(ctx) {\n  if (checkJwt(ctx)) {\n    return true;\n  }\n\n  return false;\n};","map":null,"metadata":{},"sourceType":"module"}