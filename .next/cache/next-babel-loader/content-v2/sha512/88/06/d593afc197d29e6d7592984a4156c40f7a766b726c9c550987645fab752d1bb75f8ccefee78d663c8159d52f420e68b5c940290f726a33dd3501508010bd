{"ast":null,"code":"import nextConnect from 'next-connect';\nimport middleware from '~/lib/mongodb';\n\nconst bcrypt = require('bcryptjs');\n\nconst jwt = require('jsonwebtoken');\n\nconst handler = nextConnect();\nhandler.use(middleware);\nhandler.post(async (req, res) => {\n  const user = await req.db.collection('user').findOne({\n    email: req.body.email\n  });\n\n  if (user && bcrypt.compareSync(req.body.password, user.password)) {\n    const token = jwt.sign({\n      userId: user.id,\n      userEmail: user.email\n    }, \"bluestone\", {\n      expiresIn: '1d'\n    });\n    return res.status(200).json({\n      data: {\n        userId: user._id,\n        token: token,\n        isActive: true\n      },\n      message: \"Login successfully\",\n      status: 200,\n      success: true\n    });\n  } else {\n    return res.status(400).json({\n      message: 'Password is wrong!',\n      status: 400,\n      success: false\n    });\n  }\n});\nexport default handler;","map":null,"metadata":{},"sourceType":"module"}